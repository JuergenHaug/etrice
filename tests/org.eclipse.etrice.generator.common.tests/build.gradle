plugins {
	id 'c'
	id 'cpp'
	id 'java-base'
}

apply from: "test.gradle"

def genericPhysical = 'models/GenericPhysical.etphys'

def tests = [
	actorCommunicationTest: 	['models/ActorCommunicationTest.room', genericPhysical],
	choicePointTest: 			['models/ChoicePointTest.room', genericPhysical],
	choicePointTestExtended: 	['models/ChoicePointTestExtended.room', genericPhysical],
	dataDrivenTest:				['models/DataDrivenTest.room', genericPhysical],
	//enumTest:					['models/EnumTest.room', genericPhysical],
	compileTests:				['models/CompileTests.room', genericPhysical, 'models/DetailExpressionTest.room', 'models/StatemachineInterfaceTest.room', 'models/StatemachineInterfaceInheritedTest.room', 'models/StatemachineInterfaceTest.room', 'models/ContinuationTransitionTest.room'],
	handlerTest:				['models/HandlerTest.room', genericPhysical],
	operationInheritanceTest:	['models/OperationInheritanceTest.room', genericPhysical],
	pingPongThreadTest:			['models/PingPongThreadTest.etmap', 'models/PingPongThreadTest.room'],
	pingPongThreadReplPortTest:	['models/PingPongThreadReplPortTest.etmap', 'models/PingPongThreadReplPortTest.room']
]

tests.each { key, value ->
	def testTasks = [
		addTest('c', key, value),
		addTest('cpp', key, value),
		addTest('java', key, value)
	]
	
	tasks.create(name: key, dependsOn: testTasks, group: 'verification')
}

clean.delete 'src-gen', fileTree('log') { exclude '**/readme.txt' }